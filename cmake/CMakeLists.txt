
include(${CMAKE_CURRENT_LIST_DIR}/CMakeUtilities.txt)


set(CMAKE_CXX_FLAGS " -pthread " )
add_compile_options(-ggdb  -gdwarf-2  )
#set(CMAKE_CXX_COMPILER "g++")
#set(CMAKE_CXX_COMPILER "clang++")


IF(CMAKE_SYSTEM_NAME STREQUAL OpenBSD)
	#add_definitions( -DUNIX -Wall )
	#add_definitions( -DUNIX )

	set(CMAKE_CXX_STANDARD 11)
	set(CMAKE_CXX_STANDARD_REQUIRED ON)
	set(CMAKE_CXX_EXTENSIONS OFF)

ENDIF()

IF(CMAKE_SYSTEM_NAME STREQUAL Linux)
	add_definitions( -DLINUX -Wall )
ENDIF()


if(DEFINED ENV{KRUNCHER_DEV_LIBS})
	set(INCPATH /home/jmt/Info)
	set(LIBPATH /home/jmt/Info)
	set(INCMIDFIX src/include/)
	set(LIBMIDFIX src.build/)
	if(DEFINED ENV{KRUNCHER_DEV_VERBOSE})
		message("Using KRUNCHER_DEV_LIBS")
	endif()
else()
	set(INCPATH /usr/local/include/infokruncher)
	set(LIBPATH /usr/local/lib/infokruncher)
	set(INCMIDFIX) 
	set(LIBMIDFIX)
	if(DEFINED ENV{KRUNCHER_DEV_VERBOSE})
		message("NOT Using KRUNCHER_DEV_LIBS")
	endif()
endif()


function(TraceList)
	if(DEFINED ENV{KRUNCHER_DEV_VERBOSE})
		list(GET ARGN 0 msg)
		list(GET ARGN 1 lst)
		list(GET ARGN 2 clr)
		message( ${clr} ${msg} )
		foreach(arg IN LISTS ${lst} )
			message( "\t" ${arg} )
		endforeach()	
		message( ${NormalColor} )
	endif()
endfunction()

function(Headers)
	set(INCLUDE_PATHS PARENT_SCOPE )
	foreach(arg IN LISTS ARGN)
		string(REPLACE "::" ";" PARTS ${arg})
		list (LENGTH PARTS llen)
		list(GET PARTS 0 A)

		IF(${llen} EQUAL 2)
			list(GET PARTS 1 B)
			string(CONCAT P ${INCPATH}/${A}/${INCMIDFIX}${B} )
			list(APPEND INCLUDE_PATHS ${P} )
		ENDIF(${llen} EQUAL 2)
		
		IF(${llen} EQUAL 1)
			list(APPEND INCLUDE_PATHS ${INCPATH}/${A}/${INCMIDFIX} )
		ENDIF(${llen} EQUAL 1)
	endforeach()
	set(INCLUDE_PATHS ${INCLUDE_PATHS} PARENT_SCOPE )
	TraceList( "IncludePaths" INCLUDE_PATHS ${GreenColor} )
endfunction()

function(LibraryPaths)
	set(LIBRARY_PATHS PARENT_SCOPE )
	foreach(arg IN LISTS ARGN)
		string(REPLACE "::" ";" PARTS ${arg})
		list (LENGTH PARTS llen)
		list(GET PARTS 0 A)
		list(GET PARTS 1 B)
		string(CONCAT P ${LIBPATH}/${A}/${LIBMIDFIX}${B} )
		list(APPEND LIBRARY_PATHS ${P}  )
	endforeach()	
	set(LIBRARY_PATHS ${LIBRARY_PATHS} PARENT_SCOPE )
	TraceList( "LibraryPaths" LIBRARY_PATHS ${YellowColor} )
endfunction()

function(Libraries)
	set(LIBRARIES PARENT_SCOPE )
	foreach(arg IN LISTS ARGN)
		list(APPEND LIBRARIES ${arg} )
	endforeach()	
	set(LIBRARIES ${LIBRARIES} PARENT_SCOPE )
	TraceList( "Libraries" LIBRARIES ${TealColor} )
endfunction()

